{
  "input": {
    "description": "It should run Delete Subnets by VPC and VPC has multiple subnets",
    "variables": {
      "vpcId": "vpc-0324c35cf9d083a40",
      "adapterId": "EC2"
    }
  },
  "expectedTaskResults": {
    "status": "complete",
    "variables": {
      "vpcId": "vpc-0324c35cf9d083a40",
      "adapterId": "EC2"
    }
  },
  "stubTasks": [
    {
      "taskId": "65d7",
      "variables": {
        "incoming": { "filter": [{ "name": "vpc-id", "value": "vpc-0324c35cf9d083a40" }], "subnetId": "", "dryRun": "", "nextToken": "", "maxResults": "" },
        "outgoing": {
          "result": {
            "icode": "AD.200",
            "response": {
              "DescribeSubnetsResponse": {
                "_attr": { "xmlns": "http://ec2.amazonaws.com/doc/2016-11-15/" },
                "requestId": "ac0a0621-1ccf-46ed-a3d5-9b87d1822792",
                "subnetSet": {
                  "item": [
                    {
                      "subnetId": "subnet-0fd6d26fc17380403",
                      "subnetArn": "arn:aws:ec2:us-east-1:314014972859:subnet/subnet-0fd6d26fc17380403",
                      "state": "available",
                      "ownerId": "314014972859",
                      "vpcId": "vpc-0324c35cf9d083a40",
                      "cidrBlock": "172.31.16.0/20",
                      "ipv6CidrBlockAssociationSet": "",
                      "availableIpAddressCount": "4089",
                      "availabilityZone": "us-east-1d",
                      "availabilityZoneId": "use1-az4",
                      "defaultForAz": "true",
                      "mapPublicIpOnLaunch": "true",
                      "assignIpv6AddressOnCreation": "false",
                      "mapCustomerOwnedIpOnLaunch": "false",
                      "privateDnsNameOptionsOnLaunch": { "hostnameType": "ip-name", "enableResourceNameDnsARecord": "false", "enableResourceNameDnsAAAARecord": "false" },
                      "ipv6Native": "false",
                      "enableDns64": "false"
                    },
                    {
                      "subnetId": "subnet-0db7501522876573e",
                      "subnetArn": "arn:aws:ec2:us-east-1:314014972859:subnet/subnet-0db7501522876573e",
                      "state": "available",
                      "ownerId": "314014972859",
                      "vpcId": "vpc-0324c35cf9d083a40",
                      "cidrBlock": "172.31.32.0/20",
                      "ipv6CidrBlockAssociationSet": "",
                      "availableIpAddressCount": "4091",
                      "availabilityZone": "us-east-1a",
                      "availabilityZoneId": "use1-az6",
                      "defaultForAz": "false",
                      "mapPublicIpOnLaunch": "false",
                      "assignIpv6AddressOnCreation": "false",
                      "mapCustomerOwnedIpOnLaunch": "false",
                      "privateDnsNameOptionsOnLaunch": { "hostnameType": "ip-name", "enableResourceNameDnsARecord": "false", "enableResourceNameDnsAAAARecord": "false" },
                      "ipv6Native": "false",
                      "enableDns64": "false"
                    },
                    {
                      "subnetId": "subnet-0156be65574714eb1",
                      "subnetArn": "arn:aws:ec2:us-east-1:314014972859:subnet/subnet-0156be65574714eb1",
                      "state": "available",
                      "ownerId": "314014972859",
                      "vpcId": "vpc-0324c35cf9d083a40",
                      "cidrBlock": "172.31.0.0/20",
                      "ipv6CidrBlockAssociationSet": "",
                      "availableIpAddressCount": "4091",
                      "availabilityZone": "us-east-1a",
                      "availabilityZoneId": "use1-az6",
                      "defaultForAz": "false",
                      "mapPublicIpOnLaunch": "false",
                      "assignIpv6AddressOnCreation": "false",
                      "mapCustomerOwnedIpOnLaunch": "false",
                      "privateDnsNameOptionsOnLaunch": { "hostnameType": "ip-name", "enableResourceNameDnsARecord": "false", "enableResourceNameDnsAAAARecord": "false" },
                      "ipv6Native": "false",
                      "enableDns64": "false"
                    }
                  ]
                }
              }
            }
          }
        }
      }
    },
    {
      "taskId": "d988",
      "variables": {
        "incoming": { "subnetArray": [{ "subnetId": "subnet-0fd6d26fc17380403" }, { "subnetId": "subnet-0db7501522876573e" }, { "subnetId": "subnet-0156be65574714eb1" }] },
        "outgoing": {
          "result": [
            {
              "icode": "AD.500",
              "IAPerror": {
                "origin": "EC2-connectorRest-handleEndResponse",
                "displayString": "Error 400 received on request",
                "recommendation": "Verify the request is accurate via debug logs and postman",
                "code": 400,
                "raw_response": {
                  "status": "success",
                  "code": 400,
                  "headers": {
                    "x-amzn-requestid": "48b34aab-08b3-4a51-8fd3-7c7213494a6b",
                    "cache-control": "no-cache, no-store",
                    "strict-transport-security": "max-age=31536000; includeSubDomains",
                    "vary": "accept-encoding",
                    "content-type": "text/xml;charset=UTF-8",
                    "transfer-encoding": "chunked",
                    "date": "Sun, 22 Oct 2023 17:47:03 GMT",
                    "connection": "close",
                    "server": "AmazonEC2"
                  },
                  "response": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Response><Errors><Error><Code>DependencyViolation</Code><Message>The subnet 'subnet-0fd6d26fc17380403' has dependencies and cannot be deleted.</Message></Error></Errors><RequestID>48b34aab-08b3-4a51-8fd3-7c7213494a6b</RequestID></Response>",
                  "redirects": 0,
                  "tripTime": "11034ms",
                  "reqHdr": { "Accept": "application/xml", "Host": "ec2.amazonaws.com", "X-Amz-Date": "****", "Authorization": "****", "Content-Type": "application/x-www-form-urlencoded" }
                }
              },
              "metrics": { "code": 400, "timeouts": 0, "redirects": 0, "retries": 0, "tripTime": 11034, "isThrottling": false, "capabilityTime": "12285ms" },
              "response": {
                "Response": {
                  "Errors": { "Error": { "Code": "DependencyViolation", "Message": "The subnet 'subnet-0fd6d26fc17380403' has dependencies and cannot be deleted." } },
                  "RequestID": "48b34aab-08b3-4a51-8fd3-7c7213494a6b"
                }
              }
            },
            {
              "icode": "AD.200",
              "response": { "DeleteSubnetResponse": { "_attr": { "xmlns": "http://ec2.amazonaws.com/doc/2016-11-15/" }, "requestId": "73ed9a35-3f78-4266-ba25-c3e1a44e291b", "return": "true" } },
              "headers": {
                "x-amzn-requestid": "73ed9a35-3f78-4266-ba25-c3e1a44e291b",
                "cache-control": "no-cache, no-store",
                "strict-transport-security": "max-age=31536000; includeSubDomains",
                "content-type": "text/xml;charset=UTF-8",
                "content-length": "225",
                "date": "Sun, 22 Oct 2023 17:47:04 GMT",
                "keep-alive": "timeout=20",
                "server": "AmazonEC2",
                "connection": "close"
              },
              "metrics": { "code": 200, "timeouts": 0, "redirects": 0, "retries": 0, "tripTime": 8766, "isThrottling": false, "capabilityTime": "10007ms" }
            },
            {
              "icode": "AD.200",
              "response": { "DeleteSubnetResponse": { "_attr": { "xmlns": "http://ec2.amazonaws.com/doc/2016-11-15/" }, "requestId": "2e823064-7fc7-425d-bb32-6f1f291aa533", "return": "true" } },
              "headers": {
                "x-amzn-requestid": "2e823064-7fc7-425d-bb32-6f1f291aa533",
                "cache-control": "no-cache, no-store",
                "strict-transport-security": "max-age=31536000; includeSubDomains",
                "content-type": "text/xml;charset=UTF-8",
                "content-length": "225",
                "date": "Sun, 22 Oct 2023 17:47:04 GMT",
                "keep-alive": "timeout=20",
                "server": "AmazonEC2",
                "connection": "close"
              },
              "metrics": { "code": 200, "timeouts": 0, "redirects": 0, "retries": 0, "tripTime": 1879, "isThrottling": false, "capabilityTime": "3993ms" }
            }
          ]
        }
      }
    }
  ]
}
